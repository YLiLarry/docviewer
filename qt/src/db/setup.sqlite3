CREATE TABLE IF NOT EXISTS webpage (
    id INTEGER PRIMARY KEY,
    url TEXT UNIQUE NOT NULL,
    title TEXT NOT NULL,
    html TEXT NOT NULL,
    visited INTEGER NOT NULL,
    UNIQUE (url) ON CONFLICT IGNORE
);

CREATE TABLE IF NOT EXISTS symbol (
    id INTEGER PRIMARY KEY,
    hash TEXT NOT NULL,
    text TEXT NOT NULL,
    visited INTEGER NOT NULL,
    UNIQUE (hash, text) ON CONFLICT IGNORE

);

CREATE TABLE IF NOT EXISTS webpage_symbol (
    id INTEGER PRIMARY KEY,
    webpage INTEGER NOT NULL,
    symbol INTEGER NOT NULL,
    FOREIGN KEY(webpage) REFERENCES webpage(id),
    FOREIGN KEY(symbol) REFERENCES symbol(id),
    UNIQUE (webpage, symbol) ON CONFLICT IGNORE
);

CREATE TABLE IF NOT EXISTS webpage_referer (
    id INTEGER PRIMARY KEY,
    webpage INTEGER NOT NULL,
    referer INTEGER NOT NULL,
    text TEXT NOT NULL,
    FOREIGN KEY(webpage) REFERENCES webpage(id),
    FOREIGN KEY(referer) REFERENCES referer(id),
    UNIQUE (webpage, referer) ON CONFLICT IGNORE
);
